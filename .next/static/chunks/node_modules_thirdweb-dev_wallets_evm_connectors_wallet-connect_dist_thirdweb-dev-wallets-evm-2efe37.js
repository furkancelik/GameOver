"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_thirdweb-dev_wallets_evm_connectors_wallet-connect_dist_thirdweb-dev-wallets-evm-2efe37"],{

/***/ "./node_modules/@thirdweb-dev/wallets/evm/connectors/wallet-connect/dist/thirdweb-dev-wallets-evm-connectors-wallet-connect.browser.esm.js":
/*!*************************************************************************************************************************************************!*\
  !*** ./node_modules/@thirdweb-dev/wallets/evm/connectors/wallet-connect/dist/thirdweb-dev-wallets-evm-connectors-wallet-connect.browser.esm.js ***!
  \*************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WalletConnectConnector: function() { return /* binding */ WalletConnectConnector; }\n/* harmony export */ });\n/* harmony import */ var _dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../dist/defineProperty-350fc508.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/defineProperty-350fc508.browser.esm.js\");\n/* harmony import */ var _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../dist/errors-9edc08c8.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/errors-9edc08c8.browser.esm.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ethers */ \"./node_modules/ethers/lib.esm/index.js\");\n/* harmony import */ var _dist_walletIds_dff6dced_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../dist/walletIds-dff6dced.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/walletIds-dff6dced.browser.esm.js\");\n/* harmony import */ var _dist_url_a45219bd_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../dist/url-a45219bd.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/url-a45219bd.browser.esm.js\");\n/* harmony import */ var _dist_WagmiConnector_2f14002d_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../dist/WagmiConnector-2f14002d.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/WagmiConnector-2f14002d.browser.esm.js\");\n/* harmony import */ var eventemitter3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! eventemitter3 */ \"./node_modules/eventemitter3/index.mjs\");\n\n\n\n\n\n\n\n\n\nconst chainsToRequest = new Set([1, 137, 10, 42161, 56]);\nconst NAMESPACE = \"eip155\";\nconst REQUESTED_CHAINS_KEY = \"wagmi.requestedChains\";\nconst ADD_ETH_CHAIN_METHOD = \"wallet_addEthereumChain\";\nconst LAST_USED_CHAIN_ID = \"last-used-chain-id\";\nclass WalletConnectConnector extends _dist_WagmiConnector_2f14002d_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.W {\n  constructor(config) {\n    super({\n      ...config,\n      options: {\n        isNewChainsStale: true,\n        ...config.options\n      }\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"id\", _dist_walletIds_dff6dced_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.w.walletConnect);\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"name\", \"WalletConnect\");\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"ready\", true);\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onAccountsChanged\", accounts => {\n      if (accounts.length === 0) {\n        this.emit(\"disconnect\");\n      } else {\n        if (accounts[0]) {\n          this.emit(\"change\", {\n            account: ethers__WEBPACK_IMPORTED_MODULE_4__.utils.getAddress(accounts[0])\n          });\n        }\n      }\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onChainChanged\", async chainId => {\n      const id = Number(chainId);\n      const unsupported = this.isChainUnsupported(id);\n      await this._storage.setItem(LAST_USED_CHAIN_ID, String(chainId));\n      this.emit(\"change\", {\n        chain: {\n          id,\n          unsupported\n        }\n      });\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onDisconnect\", async () => {\n      await this._setRequestedChainsIds([]);\n      await this._storage.removeItem(LAST_USED_CHAIN_ID);\n      this.emit(\"disconnect\");\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onDisplayUri\", uri => {\n      this.emit(\"message\", {\n        type: \"display_uri\",\n        data: uri\n      });\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onConnect\", () => {\n      this.emit(\"connect\", {\n        provider: this._provider\n      });\n    });\n    this._storage = config.options.storage;\n    this._createProvider();\n    this.filteredChains = this.chains.length > 50 ? this.chains.filter(c => {\n      return chainsToRequest.has(c.chainId);\n    }) : this.chains;\n    this.showWalletConnectModal = this.options.qrcode !== false;\n  }\n  async connect() {\n    let {\n      chainId: chainIdP,\n      pairingTopic\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    try {\n      let targetChainId = chainIdP;\n      if (!targetChainId) {\n        const lastUsedChainIdStr = await this._storage.getItem(LAST_USED_CHAIN_ID);\n        const lastUsedChainId = lastUsedChainIdStr ? parseInt(lastUsedChainIdStr) : undefined;\n        if (lastUsedChainId && !this.isChainUnsupported(lastUsedChainId)) {\n          targetChainId = lastUsedChainId;\n        } else {\n          targetChainId = this.filteredChains[0]?.chainId;\n        }\n      }\n      if (!targetChainId) {\n        throw new Error(\"No chains found on connector.\");\n      }\n      const provider = await this.getProvider();\n      this.setupListeners();\n      if (provider.session) {\n        await provider.disconnect();\n        const optionalChains = this.filteredChains.filter(chain => chain.chainId !== targetChainId).map(optionalChain => optionalChain.chainId);\n        this.emit(\"message\", {\n          type: \"connecting\"\n        });\n        await provider.connect({\n          pairingTopic,\n          chains: [targetChainId],\n          optionalChains: optionalChains.length > 0 ? optionalChains : [targetChainId]\n        });\n        await this._setRequestedChainsIds(this.filteredChains.map(_ref => {\n          let {\n            chainId\n          } = _ref;\n          return chainId;\n        }));\n      }\n\n      // If session exists and chains are authorized, enable provider for required chain\n      const accounts = await provider.enable();\n      if (!accounts[0]) {\n        throw new Error(\"No accounts found on provider.\");\n      }\n      const account = ethers__WEBPACK_IMPORTED_MODULE_4__.utils.getAddress(accounts[0]);\n      const id = await this.getChainId();\n      const unsupported = this.isChainUnsupported(id);\n      return {\n        account,\n        chain: {\n          id,\n          unsupported\n        },\n        provider: new ethers__WEBPACK_IMPORTED_MODULE_4__.providers.Web3Provider(provider)\n      };\n    } catch (error) {\n      if (/user rejected/i.test(error?.message)) {\n        throw new _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.U(error);\n      }\n      throw error;\n    }\n  }\n  async disconnect() {\n    const cleanup = () => {\n      if (typeof localStorage === \"undefined\") {\n        return;\n      }\n      for (const key in localStorage) {\n        if (key.startsWith(\"wc@2\")) {\n          localStorage.removeItem(key);\n        }\n      }\n    };\n    cleanup();\n    const provider = await this.getProvider();\n    const disconnectProvider = async () => {\n      try {\n        await provider.disconnect();\n      } catch (error) {\n        if (!/No matching key/i.test(error.message)) {\n          throw error;\n        }\n      } finally {\n        this._removeListeners();\n        await this._setRequestedChainsIds([]);\n        cleanup();\n      }\n    };\n    disconnectProvider();\n  }\n  async getAccount() {\n    const {\n      accounts\n    } = await this.getProvider();\n    if (!accounts[0]) {\n      throw new Error(\"No accounts found on provider.\");\n    }\n    return ethers__WEBPACK_IMPORTED_MODULE_4__.utils.getAddress(accounts[0]);\n  }\n  async getChainId() {\n    const {\n      chainId\n    } = await this.getProvider();\n    return chainId;\n  }\n  async getProvider() {\n    let {\n      chainId\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (!this._provider) {\n      await this._createProvider();\n    }\n    if (chainId) {\n      await this.switchChain(chainId);\n    }\n    if (!this._provider) {\n      throw new Error(\"No provider found.\");\n    }\n    return this._provider;\n  }\n  async getSigner() {\n    let {\n      chainId\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const [provider, account] = await Promise.all([this.getProvider({\n      chainId\n    }), this.getAccount()]);\n    return new ethers__WEBPACK_IMPORTED_MODULE_4__.providers.Web3Provider(provider, chainId).getSigner(account);\n  }\n  async isAuthorized() {\n    try {\n      const [account, provider] = await Promise.all([this.getAccount(), this.getProvider()]);\n      const isChainsStale = await this._isChainsStale();\n\n      // If an account does not exist on the session, then the connector is unauthorized.\n      if (!account) {\n        return false;\n      }\n\n      // If the chains are stale on the session, then the connector is unauthorized.\n      if (isChainsStale && provider.session) {\n        try {\n          await provider.disconnect();\n        } catch {} // eslint-disable-line no-empty\n        return false;\n      }\n      return true;\n    } catch {\n      return false;\n    }\n  }\n  async switchChain(chainId) {\n    const chain = this.chains.find(chain_ => chain_.chainId === chainId);\n    if (!chain) {\n      throw new _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.S(`Chain with ID: ${chainId}, not found on connector.`);\n    }\n    try {\n      const provider = await this.getProvider();\n      const namespaceChains = this._getNamespaceChainsIds();\n      const namespaceMethods = this._getNamespaceMethods();\n      const isChainApproved = namespaceChains.includes(chainId);\n      if (!isChainApproved && namespaceMethods.includes(ADD_ETH_CHAIN_METHOD)) {\n        const firstExplorer = chain.explorers && chain.explorers[0];\n        const blockExplorerUrls = firstExplorer ? {\n          blockExplorerUrls: [firstExplorer.url]\n        } : {};\n        await provider.request({\n          method: ADD_ETH_CHAIN_METHOD,\n          params: [{\n            chainId: ethers__WEBPACK_IMPORTED_MODULE_4__.utils.hexValue(chain.chainId),\n            chainName: chain.name,\n            nativeCurrency: chain.nativeCurrency,\n            rpcUrls: (0,_dist_url_a45219bd_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.g)(chain),\n            // no clientId on purpose\n            ...blockExplorerUrls\n          }]\n        });\n        const requestedChains = await this._getRequestedChainsIds();\n        requestedChains.push(chainId);\n        await this._setRequestedChainsIds(requestedChains);\n      }\n      await provider.request({\n        method: \"wallet_switchEthereumChain\",\n        params: [{\n          chainId: ethers__WEBPACK_IMPORTED_MODULE_4__.utils.hexValue(chainId)\n        }]\n      });\n      return chain;\n    } catch (error) {\n      const message = typeof error === \"string\" ? error : error?.message;\n      if (/user rejected request/i.test(message)) {\n        throw new _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.U(error);\n      }\n      throw new _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.S(error);\n    }\n  }\n  async _createProvider() {\n    if (!this._initProviderPromise && \"object\" !== \"undefined\") {\n      this._initProviderPromise = this.initProvider();\n    }\n    return this._initProviderPromise;\n  }\n  async initProvider() {\n    const {\n      default: EthereumProvider,\n      OPTIONAL_EVENTS,\n      OPTIONAL_METHODS\n    } = await __webpack_require__.e(/*! import() */ \"node_modules_walletconnect_ethereum-provider_dist_index_es_js\").then(__webpack_require__.bind(__webpack_require__, /*! @walletconnect/ethereum-provider */ \"./node_modules/@walletconnect/ethereum-provider/dist/index.es.js\"));\n    const [defaultChain, ...optionalChains] = this.filteredChains.map(_ref2 => {\n      let {\n        chainId\n      } = _ref2;\n      return chainId;\n    });\n    if (defaultChain) {\n      // EthereumProvider populates & deduplicates required methods and events internally\n      this._provider = await EthereumProvider.init({\n        showQrModal: this.showWalletConnectModal,\n        projectId: this.options.projectId,\n        methods: [\"eth_sendTransaction\", \"personal_sign\", \"eth_signTypedData_v4\"],\n        optionalMethods: OPTIONAL_METHODS,\n        optionalEvents: OPTIONAL_EVENTS,\n        chains: [defaultChain],\n        optionalChains: optionalChains,\n        metadata: {\n          name: this.options.dappMetadata.name,\n          description: this.options.dappMetadata.description || \"\",\n          url: this.options.dappMetadata.url,\n          icons: [this.options.dappMetadata.logoUrl || \"\"]\n        },\n        rpcMap: Object.fromEntries(this.filteredChains.map(chain => [chain.chainId, chain.rpc[0] || \"\" // TODO: handle chain.rpc being empty array\n        ])),\n        qrModalOptions: this.options.qrModalOptions\n      });\n    }\n  }\n\n  /**\n   * Checks if the target chains match the chains that were\n   * initially requested by the connector for the WalletConnect session.\n   * If there is a mismatch, this means that the chains on the connector\n   * are considered stale, and need to be revalidated at a later point (via\n   * connection).\n   *\n   * There may be a scenario where a dapp adds a chain to the\n   * connector later on, however, this chain will not have been approved or rejected\n   * by the wallet. In this case, the chain is considered stale.\n   *\n   * There are exceptions however:\n   * -  If the wallet supports dynamic chain addition via `eth_addEthereumChain`,\n   *    then the chain is not considered stale.\n   * -  If the `isNewChainsStale` flag is falsy on the connector, then the chain is\n   *    not considered stale.\n   *\n   * For the above cases, chain validation occurs dynamically when the user\n   * attempts to switch chain.\n   *\n   * Also check that dapp supports at least 1 chain from previously approved session.\n   */\n  async _isChainsStale() {\n    const namespaceMethods = this._getNamespaceMethods();\n    if (namespaceMethods.includes(ADD_ETH_CHAIN_METHOD)) {\n      return false;\n    }\n    if (!this.options.isNewChainsStale) {\n      return false;\n    }\n    const requestedChains = await this._getRequestedChainsIds();\n    const connectorChains = this.filteredChains.map(_ref3 => {\n      let {\n        chainId\n      } = _ref3;\n      return chainId;\n    });\n    const namespaceChains = this._getNamespaceChainsIds();\n    if (namespaceChains.length && !namespaceChains.some(id => connectorChains.includes(id))) {\n      return false;\n    }\n    return !connectorChains.every(id => requestedChains.includes(id));\n  }\n  async setupListeners() {\n    if (!this._provider) {\n      return;\n    }\n    this._removeListeners();\n    this._provider.on(\"accountsChanged\", this.onAccountsChanged);\n    this._provider.on(\"chainChanged\", this.onChainChanged);\n    this._provider.on(\"disconnect\", this.onDisconnect);\n    this._provider.on(\"session_delete\", this.onDisconnect);\n    this._provider.on(\"display_uri\", this.onDisplayUri);\n    this._provider.on(\"connect\", this.onConnect);\n  }\n  _removeListeners() {\n    if (!this._provider) {\n      return;\n    }\n    this._provider.removeListener(\"accountsChanged\", this.onAccountsChanged);\n    this._provider.removeListener(\"chainChanged\", this.onChainChanged);\n    this._provider.removeListener(\"disconnect\", this.onDisconnect);\n    this._provider.removeListener(\"session_delete\", this.onDisconnect);\n    this._provider.removeListener(\"display_uri\", this.onDisplayUri);\n    this._provider.removeListener(\"connect\", this.onConnect);\n  }\n  async _setRequestedChainsIds(chains) {\n    await this._storage.setItem(REQUESTED_CHAINS_KEY, JSON.stringify(chains));\n  }\n  async _getRequestedChainsIds() {\n    const data = await this._storage.getItem(REQUESTED_CHAINS_KEY);\n    return data ? JSON.parse(data) : [];\n  }\n  _getNamespaceChainsIds() {\n    if (!this._provider) {\n      return [];\n    }\n    const chainIds = this._provider.session?.namespaces[NAMESPACE]?.chains?.map(chain => parseInt(chain.split(\":\")[1] || \"\"));\n    return chainIds ?? [];\n  }\n  _getNamespaceMethods() {\n    if (!this._provider) {\n      return [];\n    }\n    const methods = this._provider.session?.namespaces[NAMESPACE]?.methods;\n    return methods ?? [];\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHRoaXJkd2ViLWRldi93YWxsZXRzL2V2bS9jb25uZWN0b3JzL3dhbGxldC1jb25uZWN0L2Rpc3QvdGhpcmR3ZWItZGV2LXdhbGxldHMtZXZtLWNvbm5lY3RvcnMtd2FsbGV0LWNvbm5lY3QuYnJvd3Nlci5lc20uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDd0I7QUFDN0U7QUFDMEM7QUFDSztBQUNLO0FBQ2hFO0FBQ1A7O0FBRXZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsMkVBQWM7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSSwrRUFBZSxhQUFhLHNFQUFTO0FBQ3pDLElBQUksK0VBQWU7QUFDbkIsSUFBSSwrRUFBZTtBQUNuQixJQUFJLCtFQUFlO0FBQ25CO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLHFCQUFxQix5Q0FBSztBQUMxQixXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJLCtFQUFlO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLElBQUksK0VBQWU7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUksK0VBQWU7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxJQUFJLCtFQUFlO0FBQ25CO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix5Q0FBSztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxzQkFBc0IsNkNBQVM7QUFDL0I7QUFDQSxNQUFNO0FBQ047QUFDQSxrQkFBa0IsbUVBQXdCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLFdBQVcseUNBQUs7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsZUFBZSw2Q0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxTQUFTO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsbUVBQWdCLG1CQUFtQixRQUFRO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix5Q0FBSztBQUMxQjtBQUNBO0FBQ0EscUJBQXFCLG9FQUFvQjtBQUN6QztBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix5Q0FBSztBQUN4QixTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQXdCO0FBQzFDO0FBQ0EsZ0JBQWdCLG1FQUFnQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sUUFBUSxzUUFBMEM7QUFDeEQ7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWtDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3dhbGxldHMvZXZtL2Nvbm5lY3RvcnMvd2FsbGV0LWNvbm5lY3QvZGlzdC90aGlyZHdlYi1kZXYtd2FsbGV0cy1ldm0tY29ubmVjdG9ycy13YWxsZXQtY29ubmVjdC5icm93c2VyLmVzbS5qcz82MjJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF8gYXMgX2RlZmluZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vLi4vLi4vZGlzdC9kZWZpbmVQcm9wZXJ0eS0zNTBmYzUwOC5icm93c2VyLmVzbS5qcyc7XG5pbXBvcnQgeyBVIGFzIFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvciwgUyBhcyBTd2l0Y2hDaGFpbkVycm9yIH0gZnJvbSAnLi4vLi4vLi4vLi4vZGlzdC9lcnJvcnMtOWVkYzA4YzguYnJvd3Nlci5lc20uanMnO1xuaW1wb3J0IHsgdXRpbHMsIHByb3ZpZGVycyB9IGZyb20gJ2V0aGVycyc7XG5pbXBvcnQgeyB3IGFzIHdhbGxldElkcyB9IGZyb20gJy4uLy4uLy4uLy4uL2Rpc3Qvd2FsbGV0SWRzLWRmZjZkY2VkLmJyb3dzZXIuZXNtLmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0VmFsaWRQdWJsaWNSUENVcmwgfSBmcm9tICcuLi8uLi8uLi8uLi9kaXN0L3VybC1hNDUyMTliZC5icm93c2VyLmVzbS5qcyc7XG5pbXBvcnQgeyBXIGFzIFdhZ21pQ29ubmVjdG9yIH0gZnJvbSAnLi4vLi4vLi4vLi4vZGlzdC9XYWdtaUNvbm5lY3Rvci0yZjE0MDAyZC5icm93c2VyLmVzbS5qcyc7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY2hhaW5zJztcbmltcG9ydCAnZXZlbnRlbWl0dGVyMyc7XG5cbmNvbnN0IGNoYWluc1RvUmVxdWVzdCA9IG5ldyBTZXQoWzEsIDEzNywgMTAsIDQyMTYxLCA1Nl0pO1xuY29uc3QgTkFNRVNQQUNFID0gXCJlaXAxNTVcIjtcbmNvbnN0IFJFUVVFU1RFRF9DSEFJTlNfS0VZID0gXCJ3YWdtaS5yZXF1ZXN0ZWRDaGFpbnNcIjtcbmNvbnN0IEFERF9FVEhfQ0hBSU5fTUVUSE9EID0gXCJ3YWxsZXRfYWRkRXRoZXJldW1DaGFpblwiO1xuY29uc3QgTEFTVF9VU0VEX0NIQUlOX0lEID0gXCJsYXN0LXVzZWQtY2hhaW4taWRcIjtcbmNsYXNzIFdhbGxldENvbm5lY3RDb25uZWN0b3IgZXh0ZW5kcyBXYWdtaUNvbm5lY3RvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHN1cGVyKHtcbiAgICAgIC4uLmNvbmZpZyxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgaXNOZXdDaGFpbnNTdGFsZTogdHJ1ZSxcbiAgICAgICAgLi4uY29uZmlnLm9wdGlvbnNcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJpZFwiLCB3YWxsZXRJZHMud2FsbGV0Q29ubmVjdCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwibmFtZVwiLCBcIldhbGxldENvbm5lY3RcIik7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwicmVhZHlcIiwgdHJ1ZSk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwib25BY2NvdW50c0NoYW5nZWRcIiwgYWNjb3VudHMgPT4ge1xuICAgICAgaWYgKGFjY291bnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aGlzLmVtaXQoXCJkaXNjb25uZWN0XCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGFjY291bnRzWzBdKSB7XG4gICAgICAgICAgdGhpcy5lbWl0KFwiY2hhbmdlXCIsIHtcbiAgICAgICAgICAgIGFjY291bnQ6IHV0aWxzLmdldEFkZHJlc3MoYWNjb3VudHNbMF0pXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJvbkNoYWluQ2hhbmdlZFwiLCBhc3luYyBjaGFpbklkID0+IHtcbiAgICAgIGNvbnN0IGlkID0gTnVtYmVyKGNoYWluSWQpO1xuICAgICAgY29uc3QgdW5zdXBwb3J0ZWQgPSB0aGlzLmlzQ2hhaW5VbnN1cHBvcnRlZChpZCk7XG4gICAgICBhd2FpdCB0aGlzLl9zdG9yYWdlLnNldEl0ZW0oTEFTVF9VU0VEX0NIQUlOX0lELCBTdHJpbmcoY2hhaW5JZCkpO1xuICAgICAgdGhpcy5lbWl0KFwiY2hhbmdlXCIsIHtcbiAgICAgICAgY2hhaW46IHtcbiAgICAgICAgICBpZCxcbiAgICAgICAgICB1bnN1cHBvcnRlZFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJvbkRpc2Nvbm5lY3RcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgdGhpcy5fc2V0UmVxdWVzdGVkQ2hhaW5zSWRzKFtdKTtcbiAgICAgIGF3YWl0IHRoaXMuX3N0b3JhZ2UucmVtb3ZlSXRlbShMQVNUX1VTRURfQ0hBSU5fSUQpO1xuICAgICAgdGhpcy5lbWl0KFwiZGlzY29ubmVjdFwiKTtcbiAgICB9KTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJvbkRpc3BsYXlVcmlcIiwgdXJpID0+IHtcbiAgICAgIHRoaXMuZW1pdChcIm1lc3NhZ2VcIiwge1xuICAgICAgICB0eXBlOiBcImRpc3BsYXlfdXJpXCIsXG4gICAgICAgIGRhdGE6IHVyaVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwib25Db25uZWN0XCIsICgpID0+IHtcbiAgICAgIHRoaXMuZW1pdChcImNvbm5lY3RcIiwge1xuICAgICAgICBwcm92aWRlcjogdGhpcy5fcHJvdmlkZXJcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHRoaXMuX3N0b3JhZ2UgPSBjb25maWcub3B0aW9ucy5zdG9yYWdlO1xuICAgIHRoaXMuX2NyZWF0ZVByb3ZpZGVyKCk7XG4gICAgdGhpcy5maWx0ZXJlZENoYWlucyA9IHRoaXMuY2hhaW5zLmxlbmd0aCA+IDUwID8gdGhpcy5jaGFpbnMuZmlsdGVyKGMgPT4ge1xuICAgICAgcmV0dXJuIGNoYWluc1RvUmVxdWVzdC5oYXMoYy5jaGFpbklkKTtcbiAgICB9KSA6IHRoaXMuY2hhaW5zO1xuICAgIHRoaXMuc2hvd1dhbGxldENvbm5lY3RNb2RhbCA9IHRoaXMub3B0aW9ucy5xcmNvZGUgIT09IGZhbHNlO1xuICB9XG4gIGFzeW5jIGNvbm5lY3QoKSB7XG4gICAgbGV0IHtcbiAgICAgIGNoYWluSWQ6IGNoYWluSWRQLFxuICAgICAgcGFpcmluZ1RvcGljXG4gICAgfSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgdHJ5IHtcbiAgICAgIGxldCB0YXJnZXRDaGFpbklkID0gY2hhaW5JZFA7XG4gICAgICBpZiAoIXRhcmdldENoYWluSWQpIHtcbiAgICAgICAgY29uc3QgbGFzdFVzZWRDaGFpbklkU3RyID0gYXdhaXQgdGhpcy5fc3RvcmFnZS5nZXRJdGVtKExBU1RfVVNFRF9DSEFJTl9JRCk7XG4gICAgICAgIGNvbnN0IGxhc3RVc2VkQ2hhaW5JZCA9IGxhc3RVc2VkQ2hhaW5JZFN0ciA/IHBhcnNlSW50KGxhc3RVc2VkQ2hhaW5JZFN0cikgOiB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChsYXN0VXNlZENoYWluSWQgJiYgIXRoaXMuaXNDaGFpblVuc3VwcG9ydGVkKGxhc3RVc2VkQ2hhaW5JZCkpIHtcbiAgICAgICAgICB0YXJnZXRDaGFpbklkID0gbGFzdFVzZWRDaGFpbklkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRhcmdldENoYWluSWQgPSB0aGlzLmZpbHRlcmVkQ2hhaW5zWzBdPy5jaGFpbklkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIXRhcmdldENoYWluSWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gY2hhaW5zIGZvdW5kIG9uIGNvbm5lY3Rvci5cIik7XG4gICAgICB9XG4gICAgICBjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0UHJvdmlkZXIoKTtcbiAgICAgIHRoaXMuc2V0dXBMaXN0ZW5lcnMoKTtcbiAgICAgIGlmIChwcm92aWRlci5zZXNzaW9uKSB7XG4gICAgICAgIGF3YWl0IHByb3ZpZGVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uYWxDaGFpbnMgPSB0aGlzLmZpbHRlcmVkQ2hhaW5zLmZpbHRlcihjaGFpbiA9PiBjaGFpbi5jaGFpbklkICE9PSB0YXJnZXRDaGFpbklkKS5tYXAob3B0aW9uYWxDaGFpbiA9PiBvcHRpb25hbENoYWluLmNoYWluSWQpO1xuICAgICAgICB0aGlzLmVtaXQoXCJtZXNzYWdlXCIsIHtcbiAgICAgICAgICB0eXBlOiBcImNvbm5lY3RpbmdcIlxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgcHJvdmlkZXIuY29ubmVjdCh7XG4gICAgICAgICAgcGFpcmluZ1RvcGljLFxuICAgICAgICAgIGNoYWluczogW3RhcmdldENoYWluSWRdLFxuICAgICAgICAgIG9wdGlvbmFsQ2hhaW5zOiBvcHRpb25hbENoYWlucy5sZW5ndGggPiAwID8gb3B0aW9uYWxDaGFpbnMgOiBbdGFyZ2V0Q2hhaW5JZF1cbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMuX3NldFJlcXVlc3RlZENoYWluc0lkcyh0aGlzLmZpbHRlcmVkQ2hhaW5zLm1hcChfcmVmID0+IHtcbiAgICAgICAgICBsZXQge1xuICAgICAgICAgICAgY2hhaW5JZFxuICAgICAgICAgIH0gPSBfcmVmO1xuICAgICAgICAgIHJldHVybiBjaGFpbklkO1xuICAgICAgICB9KSk7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIHNlc3Npb24gZXhpc3RzIGFuZCBjaGFpbnMgYXJlIGF1dGhvcml6ZWQsIGVuYWJsZSBwcm92aWRlciBmb3IgcmVxdWlyZWQgY2hhaW5cbiAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgcHJvdmlkZXIuZW5hYmxlKCk7XG4gICAgICBpZiAoIWFjY291bnRzWzBdKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGFjY291bnRzIGZvdW5kIG9uIHByb3ZpZGVyLlwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGFjY291bnQgPSB1dGlscy5nZXRBZGRyZXNzKGFjY291bnRzWzBdKTtcbiAgICAgIGNvbnN0IGlkID0gYXdhaXQgdGhpcy5nZXRDaGFpbklkKCk7XG4gICAgICBjb25zdCB1bnN1cHBvcnRlZCA9IHRoaXMuaXNDaGFpblVuc3VwcG9ydGVkKGlkKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFjY291bnQsXG4gICAgICAgIGNoYWluOiB7XG4gICAgICAgICAgaWQsXG4gICAgICAgICAgdW5zdXBwb3J0ZWRcbiAgICAgICAgfSxcbiAgICAgICAgcHJvdmlkZXI6IG5ldyBwcm92aWRlcnMuV2ViM1Byb3ZpZGVyKHByb3ZpZGVyKVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKC91c2VyIHJlamVjdGVkL2kudGVzdChlcnJvcj8ubWVzc2FnZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cbiAgYXN5bmMgZGlzY29ubmVjdCgpIHtcbiAgICBjb25zdCBjbGVhbnVwID0gKCkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiBsb2NhbFN0b3JhZ2UgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBrZXkgaW4gbG9jYWxTdG9yYWdlKSB7XG4gICAgICAgIGlmIChrZXkuc3RhcnRzV2l0aChcIndjQDJcIikpIHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBjbGVhbnVwKCk7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldFByb3ZpZGVyKCk7XG4gICAgY29uc3QgZGlzY29ubmVjdFByb3ZpZGVyID0gYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgcHJvdmlkZXIuZGlzY29ubmVjdCgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaWYgKCEvTm8gbWF0Y2hpbmcga2V5L2kudGVzdChlcnJvci5tZXNzYWdlKSkge1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICB0aGlzLl9yZW1vdmVMaXN0ZW5lcnMoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5fc2V0UmVxdWVzdGVkQ2hhaW5zSWRzKFtdKTtcbiAgICAgICAgY2xlYW51cCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgZGlzY29ubmVjdFByb3ZpZGVyKCk7XG4gIH1cbiAgYXN5bmMgZ2V0QWNjb3VudCgpIHtcbiAgICBjb25zdCB7XG4gICAgICBhY2NvdW50c1xuICAgIH0gPSBhd2FpdCB0aGlzLmdldFByb3ZpZGVyKCk7XG4gICAgaWYgKCFhY2NvdW50c1swXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gYWNjb3VudHMgZm91bmQgb24gcHJvdmlkZXIuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdXRpbHMuZ2V0QWRkcmVzcyhhY2NvdW50c1swXSk7XG4gIH1cbiAgYXN5bmMgZ2V0Q2hhaW5JZCgpIHtcbiAgICBjb25zdCB7XG4gICAgICBjaGFpbklkXG4gICAgfSA9IGF3YWl0IHRoaXMuZ2V0UHJvdmlkZXIoKTtcbiAgICByZXR1cm4gY2hhaW5JZDtcbiAgfVxuICBhc3luYyBnZXRQcm92aWRlcigpIHtcbiAgICBsZXQge1xuICAgICAgY2hhaW5JZFxuICAgIH0gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICAgIGlmICghdGhpcy5fcHJvdmlkZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuX2NyZWF0ZVByb3ZpZGVyKCk7XG4gICAgfVxuICAgIGlmIChjaGFpbklkKSB7XG4gICAgICBhd2FpdCB0aGlzLnN3aXRjaENoYWluKGNoYWluSWQpO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuX3Byb3ZpZGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBwcm92aWRlciBmb3VuZC5cIik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9wcm92aWRlcjtcbiAgfVxuICBhc3luYyBnZXRTaWduZXIoKSB7XG4gICAgbGV0IHtcbiAgICAgIGNoYWluSWRcbiAgICB9ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgICBjb25zdCBbcHJvdmlkZXIsIGFjY291bnRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW3RoaXMuZ2V0UHJvdmlkZXIoe1xuICAgICAgY2hhaW5JZFxuICAgIH0pLCB0aGlzLmdldEFjY291bnQoKV0pO1xuICAgIHJldHVybiBuZXcgcHJvdmlkZXJzLldlYjNQcm92aWRlcihwcm92aWRlciwgY2hhaW5JZCkuZ2V0U2lnbmVyKGFjY291bnQpO1xuICB9XG4gIGFzeW5jIGlzQXV0aG9yaXplZCgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgW2FjY291bnQsIHByb3ZpZGVyXSA9IGF3YWl0IFByb21pc2UuYWxsKFt0aGlzLmdldEFjY291bnQoKSwgdGhpcy5nZXRQcm92aWRlcigpXSk7XG4gICAgICBjb25zdCBpc0NoYWluc1N0YWxlID0gYXdhaXQgdGhpcy5faXNDaGFpbnNTdGFsZSgpO1xuXG4gICAgICAvLyBJZiBhbiBhY2NvdW50IGRvZXMgbm90IGV4aXN0IG9uIHRoZSBzZXNzaW9uLCB0aGVuIHRoZSBjb25uZWN0b3IgaXMgdW5hdXRob3JpemVkLlxuICAgICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgdGhlIGNoYWlucyBhcmUgc3RhbGUgb24gdGhlIHNlc3Npb24sIHRoZW4gdGhlIGNvbm5lY3RvciBpcyB1bmF1dGhvcml6ZWQuXG4gICAgICBpZiAoaXNDaGFpbnNTdGFsZSAmJiBwcm92aWRlci5zZXNzaW9uKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgcHJvdmlkZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICB9IGNhdGNoIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZW1wdHlcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGFzeW5jIHN3aXRjaENoYWluKGNoYWluSWQpIHtcbiAgICBjb25zdCBjaGFpbiA9IHRoaXMuY2hhaW5zLmZpbmQoY2hhaW5fID0+IGNoYWluXy5jaGFpbklkID09PSBjaGFpbklkKTtcbiAgICBpZiAoIWNoYWluKSB7XG4gICAgICB0aHJvdyBuZXcgU3dpdGNoQ2hhaW5FcnJvcihgQ2hhaW4gd2l0aCBJRDogJHtjaGFpbklkfSwgbm90IGZvdW5kIG9uIGNvbm5lY3Rvci5gKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRQcm92aWRlcigpO1xuICAgICAgY29uc3QgbmFtZXNwYWNlQ2hhaW5zID0gdGhpcy5fZ2V0TmFtZXNwYWNlQ2hhaW5zSWRzKCk7XG4gICAgICBjb25zdCBuYW1lc3BhY2VNZXRob2RzID0gdGhpcy5fZ2V0TmFtZXNwYWNlTWV0aG9kcygpO1xuICAgICAgY29uc3QgaXNDaGFpbkFwcHJvdmVkID0gbmFtZXNwYWNlQ2hhaW5zLmluY2x1ZGVzKGNoYWluSWQpO1xuICAgICAgaWYgKCFpc0NoYWluQXBwcm92ZWQgJiYgbmFtZXNwYWNlTWV0aG9kcy5pbmNsdWRlcyhBRERfRVRIX0NIQUlOX01FVEhPRCkpIHtcbiAgICAgICAgY29uc3QgZmlyc3RFeHBsb3JlciA9IGNoYWluLmV4cGxvcmVycyAmJiBjaGFpbi5leHBsb3JlcnNbMF07XG4gICAgICAgIGNvbnN0IGJsb2NrRXhwbG9yZXJVcmxzID0gZmlyc3RFeHBsb3JlciA/IHtcbiAgICAgICAgICBibG9ja0V4cGxvcmVyVXJsczogW2ZpcnN0RXhwbG9yZXIudXJsXVxuICAgICAgICB9IDoge307XG4gICAgICAgIGF3YWl0IHByb3ZpZGVyLnJlcXVlc3Qoe1xuICAgICAgICAgIG1ldGhvZDogQUREX0VUSF9DSEFJTl9NRVRIT0QsXG4gICAgICAgICAgcGFyYW1zOiBbe1xuICAgICAgICAgICAgY2hhaW5JZDogdXRpbHMuaGV4VmFsdWUoY2hhaW4uY2hhaW5JZCksXG4gICAgICAgICAgICBjaGFpbk5hbWU6IGNoYWluLm5hbWUsXG4gICAgICAgICAgICBuYXRpdmVDdXJyZW5jeTogY2hhaW4ubmF0aXZlQ3VycmVuY3ksXG4gICAgICAgICAgICBycGNVcmxzOiBnZXRWYWxpZFB1YmxpY1JQQ1VybChjaGFpbiksXG4gICAgICAgICAgICAvLyBubyBjbGllbnRJZCBvbiBwdXJwb3NlXG4gICAgICAgICAgICAuLi5ibG9ja0V4cGxvcmVyVXJsc1xuICAgICAgICAgIH1dXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCByZXF1ZXN0ZWRDaGFpbnMgPSBhd2FpdCB0aGlzLl9nZXRSZXF1ZXN0ZWRDaGFpbnNJZHMoKTtcbiAgICAgICAgcmVxdWVzdGVkQ2hhaW5zLnB1c2goY2hhaW5JZCk7XG4gICAgICAgIGF3YWl0IHRoaXMuX3NldFJlcXVlc3RlZENoYWluc0lkcyhyZXF1ZXN0ZWRDaGFpbnMpO1xuICAgICAgfVxuICAgICAgYXdhaXQgcHJvdmlkZXIucmVxdWVzdCh7XG4gICAgICAgIG1ldGhvZDogXCJ3YWxsZXRfc3dpdGNoRXRoZXJldW1DaGFpblwiLFxuICAgICAgICBwYXJhbXM6IFt7XG4gICAgICAgICAgY2hhaW5JZDogdXRpbHMuaGV4VmFsdWUoY2hhaW5JZClcbiAgICAgICAgfV1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGNoYWluO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gdHlwZW9mIGVycm9yID09PSBcInN0cmluZ1wiID8gZXJyb3IgOiBlcnJvcj8ubWVzc2FnZTtcbiAgICAgIGlmICgvdXNlciByZWplY3RlZCByZXF1ZXN0L2kudGVzdChtZXNzYWdlKSkge1xuICAgICAgICB0aHJvdyBuZXcgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yKGVycm9yKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBTd2l0Y2hDaGFpbkVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgX2NyZWF0ZVByb3ZpZGVyKCkge1xuICAgIGlmICghdGhpcy5faW5pdFByb3ZpZGVyUHJvbWlzZSAmJiBcIm9iamVjdFwiICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICB0aGlzLl9pbml0UHJvdmlkZXJQcm9taXNlID0gdGhpcy5pbml0UHJvdmlkZXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2luaXRQcm92aWRlclByb21pc2U7XG4gIH1cbiAgYXN5bmMgaW5pdFByb3ZpZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGRlZmF1bHQ6IEV0aGVyZXVtUHJvdmlkZXIsXG4gICAgICBPUFRJT05BTF9FVkVOVFMsXG4gICAgICBPUFRJT05BTF9NRVRIT0RTXG4gICAgfSA9IGF3YWl0IGltcG9ydCgnQHdhbGxldGNvbm5lY3QvZXRoZXJldW0tcHJvdmlkZXInKTtcbiAgICBjb25zdCBbZGVmYXVsdENoYWluLCAuLi5vcHRpb25hbENoYWluc10gPSB0aGlzLmZpbHRlcmVkQ2hhaW5zLm1hcChfcmVmMiA9PiB7XG4gICAgICBsZXQge1xuICAgICAgICBjaGFpbklkXG4gICAgICB9ID0gX3JlZjI7XG4gICAgICByZXR1cm4gY2hhaW5JZDtcbiAgICB9KTtcbiAgICBpZiAoZGVmYXVsdENoYWluKSB7XG4gICAgICAvLyBFdGhlcmV1bVByb3ZpZGVyIHBvcHVsYXRlcyAmIGRlZHVwbGljYXRlcyByZXF1aXJlZCBtZXRob2RzIGFuZCBldmVudHMgaW50ZXJuYWxseVxuICAgICAgdGhpcy5fcHJvdmlkZXIgPSBhd2FpdCBFdGhlcmV1bVByb3ZpZGVyLmluaXQoe1xuICAgICAgICBzaG93UXJNb2RhbDogdGhpcy5zaG93V2FsbGV0Q29ubmVjdE1vZGFsLFxuICAgICAgICBwcm9qZWN0SWQ6IHRoaXMub3B0aW9ucy5wcm9qZWN0SWQsXG4gICAgICAgIG1ldGhvZHM6IFtcImV0aF9zZW5kVHJhbnNhY3Rpb25cIiwgXCJwZXJzb25hbF9zaWduXCIsIFwiZXRoX3NpZ25UeXBlZERhdGFfdjRcIl0sXG4gICAgICAgIG9wdGlvbmFsTWV0aG9kczogT1BUSU9OQUxfTUVUSE9EUyxcbiAgICAgICAgb3B0aW9uYWxFdmVudHM6IE9QVElPTkFMX0VWRU5UUyxcbiAgICAgICAgY2hhaW5zOiBbZGVmYXVsdENoYWluXSxcbiAgICAgICAgb3B0aW9uYWxDaGFpbnM6IG9wdGlvbmFsQ2hhaW5zLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIG5hbWU6IHRoaXMub3B0aW9ucy5kYXBwTWV0YWRhdGEubmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5vcHRpb25zLmRhcHBNZXRhZGF0YS5kZXNjcmlwdGlvbiB8fCBcIlwiLFxuICAgICAgICAgIHVybDogdGhpcy5vcHRpb25zLmRhcHBNZXRhZGF0YS51cmwsXG4gICAgICAgICAgaWNvbnM6IFt0aGlzLm9wdGlvbnMuZGFwcE1ldGFkYXRhLmxvZ29VcmwgfHwgXCJcIl1cbiAgICAgICAgfSxcbiAgICAgICAgcnBjTWFwOiBPYmplY3QuZnJvbUVudHJpZXModGhpcy5maWx0ZXJlZENoYWlucy5tYXAoY2hhaW4gPT4gW2NoYWluLmNoYWluSWQsIGNoYWluLnJwY1swXSB8fCBcIlwiIC8vIFRPRE86IGhhbmRsZSBjaGFpbi5ycGMgYmVpbmcgZW1wdHkgYXJyYXlcbiAgICAgICAgXSkpLFxuICAgICAgICBxck1vZGFsT3B0aW9uczogdGhpcy5vcHRpb25zLnFyTW9kYWxPcHRpb25zXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHRoZSB0YXJnZXQgY2hhaW5zIG1hdGNoIHRoZSBjaGFpbnMgdGhhdCB3ZXJlXG4gICAqIGluaXRpYWxseSByZXF1ZXN0ZWQgYnkgdGhlIGNvbm5lY3RvciBmb3IgdGhlIFdhbGxldENvbm5lY3Qgc2Vzc2lvbi5cbiAgICogSWYgdGhlcmUgaXMgYSBtaXNtYXRjaCwgdGhpcyBtZWFucyB0aGF0IHRoZSBjaGFpbnMgb24gdGhlIGNvbm5lY3RvclxuICAgKiBhcmUgY29uc2lkZXJlZCBzdGFsZSwgYW5kIG5lZWQgdG8gYmUgcmV2YWxpZGF0ZWQgYXQgYSBsYXRlciBwb2ludCAodmlhXG4gICAqIGNvbm5lY3Rpb24pLlxuICAgKlxuICAgKiBUaGVyZSBtYXkgYmUgYSBzY2VuYXJpbyB3aGVyZSBhIGRhcHAgYWRkcyBhIGNoYWluIHRvIHRoZVxuICAgKiBjb25uZWN0b3IgbGF0ZXIgb24sIGhvd2V2ZXIsIHRoaXMgY2hhaW4gd2lsbCBub3QgaGF2ZSBiZWVuIGFwcHJvdmVkIG9yIHJlamVjdGVkXG4gICAqIGJ5IHRoZSB3YWxsZXQuIEluIHRoaXMgY2FzZSwgdGhlIGNoYWluIGlzIGNvbnNpZGVyZWQgc3RhbGUuXG4gICAqXG4gICAqIFRoZXJlIGFyZSBleGNlcHRpb25zIGhvd2V2ZXI6XG4gICAqIC0gIElmIHRoZSB3YWxsZXQgc3VwcG9ydHMgZHluYW1pYyBjaGFpbiBhZGRpdGlvbiB2aWEgYGV0aF9hZGRFdGhlcmV1bUNoYWluYCxcbiAgICogICAgdGhlbiB0aGUgY2hhaW4gaXMgbm90IGNvbnNpZGVyZWQgc3RhbGUuXG4gICAqIC0gIElmIHRoZSBgaXNOZXdDaGFpbnNTdGFsZWAgZmxhZyBpcyBmYWxzeSBvbiB0aGUgY29ubmVjdG9yLCB0aGVuIHRoZSBjaGFpbiBpc1xuICAgKiAgICBub3QgY29uc2lkZXJlZCBzdGFsZS5cbiAgICpcbiAgICogRm9yIHRoZSBhYm92ZSBjYXNlcywgY2hhaW4gdmFsaWRhdGlvbiBvY2N1cnMgZHluYW1pY2FsbHkgd2hlbiB0aGUgdXNlclxuICAgKiBhdHRlbXB0cyB0byBzd2l0Y2ggY2hhaW4uXG4gICAqXG4gICAqIEFsc28gY2hlY2sgdGhhdCBkYXBwIHN1cHBvcnRzIGF0IGxlYXN0IDEgY2hhaW4gZnJvbSBwcmV2aW91c2x5IGFwcHJvdmVkIHNlc3Npb24uXG4gICAqL1xuICBhc3luYyBfaXNDaGFpbnNTdGFsZSgpIHtcbiAgICBjb25zdCBuYW1lc3BhY2VNZXRob2RzID0gdGhpcy5fZ2V0TmFtZXNwYWNlTWV0aG9kcygpO1xuICAgIGlmIChuYW1lc3BhY2VNZXRob2RzLmluY2x1ZGVzKEFERF9FVEhfQ0hBSU5fTUVUSE9EKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoIXRoaXMub3B0aW9ucy5pc05ld0NoYWluc1N0YWxlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHJlcXVlc3RlZENoYWlucyA9IGF3YWl0IHRoaXMuX2dldFJlcXVlc3RlZENoYWluc0lkcygpO1xuICAgIGNvbnN0IGNvbm5lY3RvckNoYWlucyA9IHRoaXMuZmlsdGVyZWRDaGFpbnMubWFwKF9yZWYzID0+IHtcbiAgICAgIGxldCB7XG4gICAgICAgIGNoYWluSWRcbiAgICAgIH0gPSBfcmVmMztcbiAgICAgIHJldHVybiBjaGFpbklkO1xuICAgIH0pO1xuICAgIGNvbnN0IG5hbWVzcGFjZUNoYWlucyA9IHRoaXMuX2dldE5hbWVzcGFjZUNoYWluc0lkcygpO1xuICAgIGlmIChuYW1lc3BhY2VDaGFpbnMubGVuZ3RoICYmICFuYW1lc3BhY2VDaGFpbnMuc29tZShpZCA9PiBjb25uZWN0b3JDaGFpbnMuaW5jbHVkZXMoaWQpKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gIWNvbm5lY3RvckNoYWlucy5ldmVyeShpZCA9PiByZXF1ZXN0ZWRDaGFpbnMuaW5jbHVkZXMoaWQpKTtcbiAgfVxuICBhc3luYyBzZXR1cExpc3RlbmVycygpIHtcbiAgICBpZiAoIXRoaXMuX3Byb3ZpZGVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3JlbW92ZUxpc3RlbmVycygpO1xuICAgIHRoaXMuX3Byb3ZpZGVyLm9uKFwiYWNjb3VudHNDaGFuZ2VkXCIsIHRoaXMub25BY2NvdW50c0NoYW5nZWQpO1xuICAgIHRoaXMuX3Byb3ZpZGVyLm9uKFwiY2hhaW5DaGFuZ2VkXCIsIHRoaXMub25DaGFpbkNoYW5nZWQpO1xuICAgIHRoaXMuX3Byb3ZpZGVyLm9uKFwiZGlzY29ubmVjdFwiLCB0aGlzLm9uRGlzY29ubmVjdCk7XG4gICAgdGhpcy5fcHJvdmlkZXIub24oXCJzZXNzaW9uX2RlbGV0ZVwiLCB0aGlzLm9uRGlzY29ubmVjdCk7XG4gICAgdGhpcy5fcHJvdmlkZXIub24oXCJkaXNwbGF5X3VyaVwiLCB0aGlzLm9uRGlzcGxheVVyaSk7XG4gICAgdGhpcy5fcHJvdmlkZXIub24oXCJjb25uZWN0XCIsIHRoaXMub25Db25uZWN0KTtcbiAgfVxuICBfcmVtb3ZlTGlzdGVuZXJzKCkge1xuICAgIGlmICghdGhpcy5fcHJvdmlkZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5fcHJvdmlkZXIucmVtb3ZlTGlzdGVuZXIoXCJhY2NvdW50c0NoYW5nZWRcIiwgdGhpcy5vbkFjY291bnRzQ2hhbmdlZCk7XG4gICAgdGhpcy5fcHJvdmlkZXIucmVtb3ZlTGlzdGVuZXIoXCJjaGFpbkNoYW5nZWRcIiwgdGhpcy5vbkNoYWluQ2hhbmdlZCk7XG4gICAgdGhpcy5fcHJvdmlkZXIucmVtb3ZlTGlzdGVuZXIoXCJkaXNjb25uZWN0XCIsIHRoaXMub25EaXNjb25uZWN0KTtcbiAgICB0aGlzLl9wcm92aWRlci5yZW1vdmVMaXN0ZW5lcihcInNlc3Npb25fZGVsZXRlXCIsIHRoaXMub25EaXNjb25uZWN0KTtcbiAgICB0aGlzLl9wcm92aWRlci5yZW1vdmVMaXN0ZW5lcihcImRpc3BsYXlfdXJpXCIsIHRoaXMub25EaXNwbGF5VXJpKTtcbiAgICB0aGlzLl9wcm92aWRlci5yZW1vdmVMaXN0ZW5lcihcImNvbm5lY3RcIiwgdGhpcy5vbkNvbm5lY3QpO1xuICB9XG4gIGFzeW5jIF9zZXRSZXF1ZXN0ZWRDaGFpbnNJZHMoY2hhaW5zKSB7XG4gICAgYXdhaXQgdGhpcy5fc3RvcmFnZS5zZXRJdGVtKFJFUVVFU1RFRF9DSEFJTlNfS0VZLCBKU09OLnN0cmluZ2lmeShjaGFpbnMpKTtcbiAgfVxuICBhc3luYyBfZ2V0UmVxdWVzdGVkQ2hhaW5zSWRzKCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLl9zdG9yYWdlLmdldEl0ZW0oUkVRVUVTVEVEX0NIQUlOU19LRVkpO1xuICAgIHJldHVybiBkYXRhID8gSlNPTi5wYXJzZShkYXRhKSA6IFtdO1xuICB9XG4gIF9nZXROYW1lc3BhY2VDaGFpbnNJZHMoKSB7XG4gICAgaWYgKCF0aGlzLl9wcm92aWRlcikge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCBjaGFpbklkcyA9IHRoaXMuX3Byb3ZpZGVyLnNlc3Npb24/Lm5hbWVzcGFjZXNbTkFNRVNQQUNFXT8uY2hhaW5zPy5tYXAoY2hhaW4gPT4gcGFyc2VJbnQoY2hhaW4uc3BsaXQoXCI6XCIpWzFdIHx8IFwiXCIpKTtcbiAgICByZXR1cm4gY2hhaW5JZHMgPz8gW107XG4gIH1cbiAgX2dldE5hbWVzcGFjZU1ldGhvZHMoKSB7XG4gICAgaWYgKCF0aGlzLl9wcm92aWRlcikge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCBtZXRob2RzID0gdGhpcy5fcHJvdmlkZXIuc2Vzc2lvbj8ubmFtZXNwYWNlc1tOQU1FU1BBQ0VdPy5tZXRob2RzO1xuICAgIHJldHVybiBtZXRob2RzID8/IFtdO1xuICB9XG59XG5cbmV4cG9ydCB7IFdhbGxldENvbm5lY3RDb25uZWN0b3IgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@thirdweb-dev/wallets/evm/connectors/wallet-connect/dist/thirdweb-dev-wallets-evm-connectors-wallet-connect.browser.esm.js\n"));

/***/ })

}]);